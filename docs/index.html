<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Unreachable  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Unreachable  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Unreachable Docs
        </a>
         (100% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/nvzqz/Unreachable">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">Unreachable Reference</a>
      <img class="carat" src="img/carat.png" />
      Unreachable  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:11Unreachable06assertA0s5NeverOSSyXK_s12StaticStringV4fileSu4linetF">assertUnreachable(_:file:line:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:11Unreachable11unreachables5NeverOyF">unreachable()</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <p><a href="https://github.com/nvzqz/Unreachable"><img src="https://github.com/nvzqz/Unreachable/raw/assets/banner.png" alt="Unreachable"></a></p>

<p align="center">
<img src="https://img.shields.io/badge/platform-ios%20%7C%20macos%20%7C%20watchos%20%7C%20tvos%20%7C%20linux-lightgrey.svg" alt="Platform">
<img src="https://img.shields.io/badge/language-swift-orange.svg" alt="Language: Swift">
<a href="https://cocoapods.org/pods/Unreachable"><img src="https://img.shields.io/cocoapods/v/Unreachable.svg" alt="CocoaPods - Unreachable"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage"></a>
<img src="https://img.shields.io/cocoapods/dt/Unreachable.svg" alt="downloads">
<a href="https://codebeat.co/projects/github-com-nvzqz-unreachable-master"><img src="https://codebeat.co/badges/3e01a261-54d1-400e-8820-6aadb177c01a" alt="codebeat badge"></a>
<img src="https://img.shields.io/badge/license-MIT-000000.svg" alt="License">
</p>

<p>Unreachable is a Swift µframework that allows for letting the compiler know when
a code path is unreachable.</p>

<ul>
<li><a href="#build-status">Build Status</a></li>
<li><a href="#installation">Installation</a>

<ul>
<li><a href="#compatibility">Compatibility</a></li>
<li><a href="#install-using-swift-package-manager">Swift Package Manager</a></li>
<li><a href="#install-using-cocoapods">CocoaPods</a></li>
<li><a href="#install-using-carthage">Carthage</a></li>
</ul></li>
<li><a href="#usage">Usage</a>

<ul>
<li><a href="#dynamic-loop-exit">Dynamic Loop Exit</a></li>
<li><a href="#switch-conditions">Switch Conditions</a></li>
<li><a href="#safety">Safety</a></li>
<li><a href="#unreachable-vs-fatalerror">Unreachable vs fatalError</a>

<ul>
<li><a href="#with-unreachable">Unreachable Example</a></li>
<li><a href="#with-fatalerror">fatalError Example</a></li>
</ul></li>
</ul></li>
<li><a href="#license">License</a></li>
</ul>
<a href='#build-status' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='build-status'>Build Status</h2>

<table><thead>
<tr>
<th style="text-align: center">Branch</th>
<th style="text-align: center">Status</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center"><code>master</code></td>
<td style="text-align: center"><a href="https://travis-ci.org/nvzqz/Unreachable"><img src="https://travis-ci.org/nvzqz/Unreachable.svg?branch=master" alt="Build Status"></a></td>
</tr>
</tbody></table>
<a href='#installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='installation'>Installation</h2>
<a href='#compatibility' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='compatibility'>Compatibility</h3>

<ul>
<li>Platforms:

<ul>
<li>macOS 10.9+</li>
<li>iOS 8.0+</li>
<li>watchOS 2.0+</li>
<li>tvOS 9.0+</li>
<li>Linux</li>
</ul></li>
<li>Xcode 8.0+</li>
<li>Swift 3.0+ &amp; 4.0</li>
</ul>
<a href='#install-using-swift-package-manager' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='install-using-swift-package-manager'>Install Using Swift Package Manager</h3>

<p>The <a href="https://swift.org/package-manager/">Swift Package Manager</a> is a
decentralized dependency manager for Swift.</p>

<ol>
<li><p>Add the project to your <code>Package.swift</code>.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"MyAwesomeProject"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/nvzqz/Unreachable.git"</span><span class="p">,</span>
                 <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></li>
<li><p>Import the Unreachable module.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Unreachable</span>
</code></pre></li>
</ol>
<a href='#install-using-cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='install-using-cocoapods'>Install Using CocoaPods</h3>

<p><a href="https://cocoapods.org/">CocoaPods</a> is a centralized dependency manager for
Objective-C and Swift. Go <a href="https://guides.cocoapods.org/using/index.html">here</a>
to learn more.</p>

<ol>
<li><p>Add the project to your <a href="https://guides.cocoapods.org/using/the-podfile.html">Podfile</a>.</p>
<pre class="highlight ruby"><code><span class="n">use_frameworks!</span>

<span class="n">pod</span> <span class="s1">'Unreachable'</span><span class="p">,</span> <span class="s1">'~&gt; 1.2.0'</span>
</code></pre>

<p>If you want to be on the bleeding edge, replace the last line with:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'Unreachable'</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/nvzqz/Unreachable.git'</span>
</code></pre></li>
<li><p>Run <code>pod install</code> and open the <code>.xcworkspace</code> file to launch Xcode.</p></li>
<li><p>Import the Unreachable framework.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Unreachable</span>
</code></pre></li>
</ol>
<a href='#install-using-carthage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='install-using-carthage'>Install Using Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage">Carthage</a> is a decentralized dependency
manager for Objective-C and Swift.</p>

<ol>
<li><p>Add the project to your <a href="https://github.com/Carthage/Carthage/blob/master/Documentation/Artifacts.md#cartfile">Cartfile</a>.</p>
<pre class="highlight plaintext"><code>github "nvzqz/Unreachable"
</code></pre></li>
<li><p>Run <code>carthage update</code> and follow <a href="https://github.com/Carthage/Carthage#getting-started">the additional steps</a>
in order to add Unreachable to your project.</p></li>
<li><p>Import the Unreachable framework.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Unreachable</span>
</code></pre></li>
</ol>
<a href='#install-manually' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='install-manually'>Install Manually</h3>

<p>Simply add <code>Unreachable.swift</code> into your project.</p>
<a href='#usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='usage'>Usage</h2>

<p>Try it out for yourself! Download the repo and open &lsquo;Unreachable.playground&rsquo;.</p>
<a href='#dynamic-loop-exit' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='dynamic-loop-exit'>Dynamic Loop Exit</h3>

<p>In some cases, the only way a function returns a value is from within a loop,
but the compiler may not have enough information to know that.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">getValue</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">...</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">20</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">i</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nf">assertUnreachable</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
<a href='#switch-conditions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='switch-conditions'>Switch Conditions</h3>

<p>A <code>switch</code> statement may have conditions applied to its branches that make it
exhaustive, but that may not obvious to the compiler.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">sign</span><span class="p">(</span><span class="n">of</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Double</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">FloatingPointSign</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">value</span> <span class="p">{</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">x</span><span class="p">?</span> <span class="k">where</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">plus</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">x</span><span class="p">?</span> <span class="k">where</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">minus</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">some</span><span class="p">:</span>
        <span class="nf">assertUnreachable</span><span class="p">()</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">none</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<a href='#safety' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='safety'>Safety</h3>

<p>It is <a href="https://en.wikipedia.org/wiki/Undefined_behavior">undefined behavior</a> for <code>unreachable()</code> to be called. To protect
against this, it is recommended to use <code>assertUnreachable()</code> instead.</p>

<p>With <code>assertUnreachable()</code>, debug builds will exit via a fatal error if the
function is called. In optimized builds, it&rsquo;s no different than calling
<code>unreachable()</code>.</p>
<a href='#unreachable-vs-code-fatalerror-code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='unreachable-vs-code-fatalerror-code'>Unreachable vs <code>fatalError()</code></h3>

<p>The <code>assertUnreachable()</code> function can be used as somewhat of a drop-in
replacement for <code>fatalError()</code>. In debug mode, they emit similar instructions.
However, when compiling with optimizations, <code>assertUnreachable()</code> allows its
parent to emit very few instructions.</p>

<p>Here we&rsquo;re checking whether a <code>UnicodeScalar</code> has a value in the lower or upper
range. Because we know that these are the only valid ranges, we can let the
compiler know that the third branch is unreachable. If at some point <code>x</code> has a
value that&rsquo;s not within either range, it will emit an assertion failure in
unoptimized builds.</p>
<a href='#with-unreachable' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='with-unreachable'>With Unreachable</h4>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">isLowerRange</span><span class="p">(</span><span class="n">_</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">UnicodeScalar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">...</span><span class="mh">0xD7FF</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="k">case</span> <span class="mh">0xE000</span><span class="o">...</span><span class="mh">0x10FFFF</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="nf">assertUnreachable</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Assembly output:</p>
<pre class="highlight plaintext"><code>        .globl  __T011Unreachable12isLowerRangeSbs7UnicodeO6ScalarVF
        .p2align        4, 0x90
__T011Unreachable12isLowerRangeSbs7UnicodeO6ScalarVF:
        pushq   %rbp
        movq    %rsp, %rbp
        cmpl    $55296, %edi
        setb    %al
        popq    %rbp
        retq
</code></pre>
<a href='#with-code-fatalerror-code' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='with-code-fatalerror-code'>With <code>fatalError()</code></h4>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">isLowerRange</span><span class="p">(</span><span class="n">_</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">UnicodeScalar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">...</span><span class="mh">0xD7FF</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="k">case</span> <span class="mh">0xE000</span><span class="o">...</span><span class="mh">0x10FFFF</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Unreachable"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Assembly output:</p>
<pre class="highlight plaintext"><code>        .globl  __T011Unreachable12isLowerRangeSbs7UnicodeO6ScalarVF
        .p2align        4, 0x90
__T011Unreachable12isLowerRangeSbs7UnicodeO6ScalarVF:
        .cfi_startproc
        movb    $1, %al
        cmpl    $55296, %edi
        jb      LBB4_3
        addl    $-57344, %edi
        cmpl    $1056768, %edi
        jae     LBB4_4
        xorl    %eax, %eax
LBB4_3:
        retq
LBB4_4:
        pushq   %rbp
Lcfi0:
        .cfi_def_cfa_offset 16
Lcfi1:
        .cfi_offset %rbp, -16
        movq    %rsp, %rbp
Lcfi2:
        .cfi_def_cfa_register %rbp
        subq    $48, %rsp
        leaq    L___unnamed_2(%rip), %rax
        movq    %rax, (%rsp)
        movl    $0, 32(%rsp)
        movq    $56, 24(%rsp)
        movl    $2, 16(%rsp)
        movq    $69, 8(%rsp)
        leaq    L___unnamed_3(%rip), %rdi
        leaq    L___unnamed_4(%rip), %rcx
        movl    $11, %esi
        movl    $2, %edx
        movl    $11, %r8d
        xorl    %r9d, %r9d
        callq   __T0s17_assertionFailures5NeverOs12StaticStringV_SSAE4fileSu4lines6UInt32V5flagstFTfq4nxnnn_n
        subq    $40, %rsp
        .cfi_endproc
</code></pre>
<a href='#license' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='license'>License</h2>

<p>All source code for Unreachable is released under the <a href="https://github.com/nvzqz/Unreachable/blob/master/LICENSE.md">MIT License</a>.</p>

<p>Assets for Unreachable are released under the <a href="https://github.com/nvzqz/Unreachable/blob/assets/LICENSE.txt">CC BY-SA 4.0 License</a>
and can be found in the <a href="https://github.com/nvzqz/Unreachable/tree/assets"><code>assets</code> branch</a>.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2017 <a class="link" href="https://github.com/nvzqz" target="_blank" rel="external">Nikolai Vazquez</a>. All rights reserved. (Last updated: 2017-07-03)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
